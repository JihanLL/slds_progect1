W0519 04:12:25.099760 3006009 torch/distributed/run.py:793] 
W0519 04:12:25.099760 3006009 torch/distributed/run.py:793] *****************************************
W0519 04:12:25.099760 3006009 torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0519 04:12:25.099760 3006009 torch/distributed/run.py:793] *****************************************
DDP: Rank 7/8 initialized. Using GPU: 7.
Process Global Rank: 7, World Size: 8. Using device: cuda:7
DDP: Rank 2/8 initialized. Using GPU: 2.
DDP: Rank 3/8 initialized. Using GPU: 3.
Process Global Rank: 2, World Size: 8. Using device: cuda:2
Process Global Rank: 3, World Size: 8. Using device: cuda:3
DDP: Rank 1/8 initialized. Using GPU: 1.
Process Global Rank: 1, World Size: 8. Using device: cuda:1
DDP: Rank 6/8 initialized. Using GPU: 6.
Process Global Rank: 6, World Size: 8. Using device: cuda:6
DDP: Rank 4/8 initialized. Using GPU: 4.
Process Global Rank: 4, World Size: 8. Using device: cuda:4
DDP: Rank 0/8 initialized. Using GPU: 0.
Script arguments: Namespace(seed=42, epochs=80, dataset='DDR', ddr_root_dir='data/DDR', full_dataset=True, optimizer='adam', learning_rate=0.001, L1_parameter=1e-05, L2_parameter=1e-05, momentum=0.9, batch_size=128, num_workers=12, milestones=[10, 20, 30], model='CNNv4', flopanalysis=False, log_wrong_type=False, dist_eval=False, local_rank=0)
Process Global Rank: 0, World Size: 8. Using device: cuda:0
DDP: Rank 5/8 initialized. Using GPU: 5.
Process Global Rank: 5, World Size: 8. Using device: cuda:5
[Rank 0] Epoch 1/80 training time: 24.94 seconds
[Rank 0] Epoch 1/80 evaluation time: 10.55 seconds
Max accuracy so far: 36.6%
Epoch 1 - Test Acc: 36.6%, Test Loss: 1.417056
[Rank 0] Epoch 2/80 training time: 22.79 seconds
[Rank 0] Epoch 2/80 evaluation time: 10.95 seconds
Max accuracy so far: 36.7%
Epoch 2 - Test Acc: 36.7%, Test Loss: 1.545397
[Rank 0] Epoch 3/80 training time: 23.00 seconds
[Rank 0] Epoch 3/80 evaluation time: 11.00 seconds
Max accuracy so far: 36.7%
Epoch 3 - Test Acc: 33.3%, Test Loss: 1.885846
[Rank 0] Epoch 4/80 training time: 21.87 seconds
[Rank 0] Epoch 4/80 evaluation time: 10.67 seconds
Max accuracy so far: 37.5%
Epoch 4 - Test Acc: 37.5%, Test Loss: 1.737252
[Rank 0] Epoch 5/80 training time: 22.40 seconds
[Rank 0] Epoch 5/80 evaluation time: 10.84 seconds
Max accuracy so far: 45.3%
Epoch 5 - Test Acc: 45.3%, Test Loss: 1.321384
[Rank 0] Epoch 6/80 training time: 22.49 seconds
[Rank 0] Epoch 6/80 evaluation time: 10.77 seconds
Max accuracy so far: 55.8%
Epoch 6 - Test Acc: 55.8%, Test Loss: 1.048612
[Rank 0] Epoch 7/80 training time: 22.77 seconds
[Rank 0] Epoch 7/80 evaluation time: 10.84 seconds
Max accuracy so far: 55.8%
Epoch 7 - Test Acc: 49.7%, Test Loss: 1.311640
[Rank 0] Epoch 8/80 training time: 21.88 seconds
[Rank 0] Epoch 8/80 evaluation time: 10.90 seconds
Max accuracy so far: 55.8%
Epoch 8 - Test Acc: 46.2%, Test Loss: 1.286484
[Rank 0] Epoch 9/80 training time: 22.41 seconds
[Rank 0] Epoch 9/80 evaluation time: 10.53 seconds
Max accuracy so far: 55.8%
Epoch 9 - Test Acc: 41.5%, Test Loss: 1.462912
[Rank 0] Epoch 10/80 training time: 22.02 seconds
[Rank 0] Epoch 10/80 evaluation time: 10.74 seconds
Max accuracy so far: 55.8%
Epoch 10 - Test Acc: 39.8%, Test Loss: 1.553315
Saved checkpoint to checkpoints/model_epoch10.pth
[Rank 0] Epoch 11/80 training time: 22.90 seconds
[Rank 0] Epoch 11/80 evaluation time: 10.98 seconds
Max accuracy so far: 55.8%
Epoch 11 - Test Acc: 44.8%, Test Loss: 1.701502
[Rank 0] Epoch 12/80 training time: 22.84 seconds
[Rank 0] Epoch 12/80 evaluation time: 11.06 seconds
Max accuracy so far: 55.8%
Epoch 12 - Test Acc: 35.6%, Test Loss: 2.339536
[Rank 0] Epoch 13/80 training time: 21.98 seconds
[Rank 0] Epoch 13/80 evaluation time: 10.79 seconds
Max accuracy so far: 55.8%
Epoch 13 - Test Acc: 35.0%, Test Loss: 1.579859
[Rank 0] Epoch 14/80 training time: 23.10 seconds
[Rank 0] Epoch 14/80 evaluation time: 11.31 seconds
Max accuracy so far: 55.8%
Epoch 14 - Test Acc: 44.8%, Test Loss: 1.315052
[Rank 0] Epoch 15/80 training time: 22.73 seconds
[Rank 0] Epoch 15/80 evaluation time: 10.83 seconds
Max accuracy so far: 61.8%
Epoch 15 - Test Acc: 61.8%, Test Loss: 1.014726
[Rank 0] Epoch 16/80 training time: 21.91 seconds
[Rank 0] Epoch 16/80 evaluation time: 10.66 seconds
Max accuracy so far: 63.8%
Epoch 16 - Test Acc: 63.8%, Test Loss: 0.991477
[Rank 0] Epoch 17/80 training time: 22.26 seconds
[Rank 0] Epoch 17/80 evaluation time: 10.94 seconds
Max accuracy so far: 63.8%
Epoch 17 - Test Acc: 61.1%, Test Loss: 1.077964
[Rank 0] Epoch 18/80 training time: 22.14 seconds
[Rank 0] Epoch 18/80 evaluation time: 10.66 seconds
Max accuracy so far: 63.8%
Epoch 18 - Test Acc: 61.9%, Test Loss: 0.996614
[Rank 0] Epoch 19/80 training time: 22.60 seconds
[Rank 0] Epoch 19/80 evaluation time: 10.70 seconds
Max accuracy so far: 64.3%
Epoch 19 - Test Acc: 64.3%, Test Loss: 0.933199
[Rank 0] Epoch 20/80 training time: 22.01 seconds
[Rank 0] Epoch 20/80 evaluation time: 10.61 seconds
Max accuracy so far: 64.3%
Epoch 20 - Test Acc: 64.2%, Test Loss: 0.912908
Saved checkpoint to checkpoints/model_epoch20.pth
[Rank 0] Epoch 21/80 training time: 22.56 seconds
[Rank 0] Epoch 21/80 evaluation time: 11.09 seconds
Max accuracy so far: 64.5%
Epoch 21 - Test Acc: 64.5%, Test Loss: 0.910762
[Rank 0] Epoch 22/80 training time: 22.12 seconds
[Rank 0] Epoch 22/80 evaluation time: 11.70 seconds
Max accuracy so far: 65.0%
Epoch 22 - Test Acc: 65.0%, Test Loss: 0.900627
[Rank 0] Epoch 23/80 training time: 21.81 seconds
[Rank 0] Epoch 23/80 evaluation time: 10.93 seconds
Max accuracy so far: 65.0%
Epoch 23 - Test Acc: 60.1%, Test Loss: 0.958085
[Rank 0] Epoch 24/80 training time: 23.33 seconds
[Rank 0] Epoch 24/80 evaluation time: 10.71 seconds
Max accuracy so far: 65.0%
Epoch 24 - Test Acc: 57.6%, Test Loss: 1.267934
[Rank 0] Epoch 25/80 training time: 21.65 seconds
[Rank 0] Epoch 25/80 evaluation time: 10.82 seconds
Max accuracy so far: 65.0%
Epoch 25 - Test Acc: 62.3%, Test Loss: 0.933186
[Rank 0] Epoch 26/80 training time: 22.90 seconds
[Rank 0] Epoch 26/80 evaluation time: 10.86 seconds
Max accuracy so far: 65.0%
Epoch 26 - Test Acc: 64.5%, Test Loss: 0.912694
[Rank 0] Epoch 27/80 training time: 22.37 seconds
[Rank 0] Epoch 27/80 evaluation time: 10.89 seconds
Max accuracy so far: 65.5%
Epoch 27 - Test Acc: 65.5%, Test Loss: 0.903296
[Rank 0] Epoch 28/80 training time: 22.60 seconds
[Rank 0] Epoch 28/80 evaluation time: 11.03 seconds
Max accuracy so far: 65.5%
Epoch 28 - Test Acc: 64.6%, Test Loss: 0.909474
[Rank 0] Epoch 29/80 training time: 22.12 seconds
[Rank 0] Epoch 29/80 evaluation time: 10.89 seconds
Max accuracy so far: 65.5%
Epoch 29 - Test Acc: 64.6%, Test Loss: 0.933072
[Rank 0] Epoch 30/80 training time: 21.91 seconds
[Rank 0] Epoch 30/80 evaluation time: 10.74 seconds
Max accuracy so far: 65.5%
Epoch 30 - Test Acc: 64.4%, Test Loss: 0.889599
Saved checkpoint to checkpoints/model_epoch30.pth
[Rank 0] Epoch 31/80 training time: 22.23 seconds
[Rank 0] Epoch 31/80 evaluation time: 10.90 seconds
Max accuracy so far: 66.2%
Epoch 31 - Test Acc: 66.2%, Test Loss: 0.884528
[Rank 0] Epoch 32/80 training time: 22.95 seconds
[Rank 0] Epoch 32/80 evaluation time: 10.92 seconds
Max accuracy so far: 66.6%
Epoch 32 - Test Acc: 66.6%, Test Loss: 0.882280
[Rank 0] Epoch 33/80 training time: 22.40 seconds
[Rank 0] Epoch 33/80 evaluation time: 10.78 seconds
Max accuracy so far: 66.6%
Epoch 33 - Test Acc: 66.0%, Test Loss: 0.889204
[Rank 0] Epoch 34/80 training time: 22.35 seconds
[Rank 0] Epoch 34/80 evaluation time: 11.37 seconds
Max accuracy so far: 66.6%
Epoch 34 - Test Acc: 66.6%, Test Loss: 0.878449
[Rank 0] Epoch 35/80 training time: 22.62 seconds
[Rank 0] Epoch 35/80 evaluation time: 10.74 seconds
Max accuracy so far: 66.6%
Epoch 35 - Test Acc: 66.1%, Test Loss: 0.888555
[Rank 0] Epoch 36/80 training time: 22.69 seconds
[Rank 0] Epoch 36/80 evaluation time: 11.39 seconds
Max accuracy so far: 66.6%
Epoch 36 - Test Acc: 65.1%, Test Loss: 0.885028
[Rank 0] Epoch 37/80 training time: 22.89 seconds
[Rank 0] Epoch 37/80 evaluation time: 10.69 seconds
Max accuracy so far: 66.6%
Epoch 37 - Test Acc: 65.6%, Test Loss: 0.880091
[Rank 0] Epoch 38/80 training time: 22.62 seconds
[Rank 0] Epoch 38/80 evaluation time: 10.57 seconds
Max accuracy so far: 66.6%
Epoch 38 - Test Acc: 66.4%, Test Loss: 0.876169
[Rank 0] Epoch 39/80 training time: 22.34 seconds
[Rank 0] Epoch 39/80 evaluation time: 10.99 seconds
Max accuracy so far: 66.6%
Epoch 39 - Test Acc: 66.1%, Test Loss: 0.880197
[Rank 0] Epoch 40/80 training time: 22.33 seconds
[Rank 0] Epoch 40/80 evaluation time: 11.27 seconds
Max accuracy so far: 66.6%
Epoch 40 - Test Acc: 65.9%, Test Loss: 0.881608
Saved checkpoint to checkpoints/model_epoch40.pth
[Rank 0] Epoch 41/80 training time: 22.34 seconds
[Rank 0] Epoch 41/80 evaluation time: 11.15 seconds
Max accuracy so far: 66.6%
Epoch 41 - Test Acc: 65.8%, Test Loss: 0.880648
[Rank 0] Epoch 42/80 training time: 22.65 seconds
[Rank 0] Epoch 42/80 evaluation time: 11.13 seconds
Max accuracy so far: 67.4%
Epoch 42 - Test Acc: 67.4%, Test Loss: 0.875223
[Rank 0] Epoch 43/80 training time: 22.46 seconds
[Rank 0] Epoch 43/80 evaluation time: 10.76 seconds
Max accuracy so far: 67.4%
Epoch 43 - Test Acc: 67.1%, Test Loss: 0.872090
[Rank 0] Epoch 44/80 training time: 22.04 seconds
[Rank 0] Epoch 44/80 evaluation time: 10.83 seconds
Max accuracy so far: 67.4%
Epoch 44 - Test Acc: 67.1%, Test Loss: 0.875026
[Rank 0] Epoch 45/80 training time: 22.20 seconds
[Rank 0] Epoch 45/80 evaluation time: 10.61 seconds
Max accuracy so far: 67.4%
Epoch 45 - Test Acc: 66.5%, Test Loss: 0.876383
[Rank 0] Epoch 46/80 training time: 22.62 seconds
[Rank 0] Epoch 46/80 evaluation time: 10.75 seconds
Max accuracy so far: 67.4%
Epoch 46 - Test Acc: 66.9%, Test Loss: 0.880636
[Rank 0] Epoch 47/80 training time: 22.85 seconds
[Rank 0] Epoch 47/80 evaluation time: 11.09 seconds
Max accuracy so far: 67.4%
Epoch 47 - Test Acc: 67.4%, Test Loss: 0.876667
[Rank 0] Epoch 48/80 training time: 22.08 seconds
[Rank 0] Epoch 48/80 evaluation time: 11.33 seconds
Max accuracy so far: 67.4%
Epoch 48 - Test Acc: 66.9%, Test Loss: 0.873133
[Rank 0] Epoch 49/80 training time: 22.95 seconds
[Rank 0] Epoch 49/80 evaluation time: 10.83 seconds
Max accuracy so far: 67.4%
Epoch 49 - Test Acc: 67.0%, Test Loss: 0.865237
[Rank 0] Epoch 50/80 training time: 23.05 seconds
[Rank 0] Epoch 50/80 evaluation time: 11.29 seconds
Max accuracy so far: 67.4%
Epoch 50 - Test Acc: 66.8%, Test Loss: 0.875531
Saved checkpoint to checkpoints/model_epoch50.pth
[Rank 0] Epoch 51/80 training time: 22.50 seconds
[Rank 0] Epoch 51/80 evaluation time: 11.11 seconds
Max accuracy so far: 67.4%
Epoch 51 - Test Acc: 67.1%, Test Loss: 0.870154
[Rank 0] Epoch 52/80 training time: 22.41 seconds
[Rank 0] Epoch 52/80 evaluation time: 10.87 seconds
Max accuracy so far: 67.4%
Epoch 52 - Test Acc: 65.9%, Test Loss: 0.879373
[Rank 0] Epoch 53/80 training time: 22.31 seconds
[Rank 0] Epoch 53/80 evaluation time: 10.63 seconds
Max accuracy so far: 67.4%
Epoch 53 - Test Acc: 66.9%, Test Loss: 0.869809
[Rank 0] Epoch 54/80 training time: 21.76 seconds
[Rank 0] Epoch 54/80 evaluation time: 10.97 seconds
Max accuracy so far: 67.5%
Epoch 54 - Test Acc: 67.5%, Test Loss: 0.871677
[Rank 0] Epoch 55/80 training time: 22.42 seconds
[Rank 0] Epoch 55/80 evaluation time: 10.54 seconds
Max accuracy so far: 67.5%
Epoch 55 - Test Acc: 67.1%, Test Loss: 0.868131
[Rank 0] Epoch 56/80 training time: 22.66 seconds
[Rank 0] Epoch 56/80 evaluation time: 10.91 seconds
Max accuracy so far: 67.5%
Epoch 56 - Test Acc: 67.3%, Test Loss: 0.878144
[Rank 0] Epoch 57/80 training time: 22.12 seconds
[Rank 0] Epoch 57/80 evaluation time: 11.03 seconds
Max accuracy so far: 67.5%
Epoch 57 - Test Acc: 66.1%, Test Loss: 0.867080
[Rank 0] Epoch 58/80 training time: 22.44 seconds
[Rank 0] Epoch 58/80 evaluation time: 10.83 seconds
Max accuracy so far: 67.5%
Epoch 58 - Test Acc: 67.1%, Test Loss: 0.869811
[Rank 0] Epoch 59/80 training time: 22.24 seconds
[Rank 0] Epoch 59/80 evaluation time: 10.99 seconds
Max accuracy so far: 67.5%
Epoch 59 - Test Acc: 67.3%, Test Loss: 0.870417
[Rank 0] Epoch 60/80 training time: 22.57 seconds
[Rank 0] Epoch 60/80 evaluation time: 11.16 seconds
Max accuracy so far: 67.5%
Epoch 60 - Test Acc: 67.5%, Test Loss: 0.866331
Saved checkpoint to checkpoints/model_epoch60.pth
[Rank 0] Epoch 61/80 training time: 22.25 seconds
[Rank 0] Epoch 61/80 evaluation time: 10.61 seconds
Max accuracy so far: 67.5%
Epoch 61 - Test Acc: 67.2%, Test Loss: 0.873466
[Rank 0] Epoch 62/80 training time: 22.19 seconds
[Rank 0] Epoch 62/80 evaluation time: 10.67 seconds
Max accuracy so far: 67.5%
Epoch 62 - Test Acc: 66.5%, Test Loss: 0.870434
[Rank 0] Epoch 63/80 training time: 21.82 seconds
[Rank 0] Epoch 63/80 evaluation time: 10.79 seconds
Max accuracy so far: 67.5%
Epoch 63 - Test Acc: 67.1%, Test Loss: 0.869772
[Rank 0] Epoch 64/80 training time: 22.22 seconds
[Rank 0] Epoch 64/80 evaluation time: 10.61 seconds
Max accuracy so far: 67.5%
Epoch 64 - Test Acc: 67.0%, Test Loss: 0.868849
[Rank 0] Epoch 65/80 training time: 22.00 seconds
[Rank 0] Epoch 65/80 evaluation time: 11.03 seconds
Max accuracy so far: 67.5%
Epoch 65 - Test Acc: 66.5%, Test Loss: 0.875010
[Rank 0] Epoch 66/80 training time: 22.85 seconds
[Rank 0] Epoch 66/80 evaluation time: 10.88 seconds
Max accuracy so far: 67.5%
Epoch 66 - Test Acc: 66.6%, Test Loss: 0.877040
[Rank 0] Epoch 67/80 training time: 22.46 seconds
[Rank 0] Epoch 67/80 evaluation time: 10.97 seconds
Max accuracy so far: 67.5%
Epoch 67 - Test Acc: 67.1%, Test Loss: 0.872644
[Rank 0] Epoch 68/80 training time: 22.26 seconds
[Rank 0] Epoch 68/80 evaluation time: 10.94 seconds
Max accuracy so far: 67.5%
Epoch 68 - Test Acc: 67.3%, Test Loss: 0.872129
[Rank 0] Epoch 69/80 training time: 22.85 seconds
[Rank 0] Epoch 69/80 evaluation time: 10.79 seconds
Max accuracy so far: 67.5%
Epoch 69 - Test Acc: 67.0%, Test Loss: 0.872717
[Rank 0] Epoch 70/80 training time: 21.87 seconds
[Rank 0] Epoch 70/80 evaluation time: 10.65 seconds
Max accuracy so far: 67.9%
Epoch 70 - Test Acc: 67.9%, Test Loss: 0.867721
Saved checkpoint to checkpoints/model_epoch70.pth
[Rank 0] Epoch 71/80 training time: 21.90 seconds
[Rank 0] Epoch 71/80 evaluation time: 11.11 seconds
Max accuracy so far: 67.9%
Epoch 71 - Test Acc: 67.3%, Test Loss: 0.873475
[Rank 0] Epoch 72/80 training time: 22.00 seconds
[Rank 0] Epoch 72/80 evaluation time: 10.94 seconds
Max accuracy so far: 67.9%
Epoch 72 - Test Acc: 66.8%, Test Loss: 0.873410
[Rank 0] Epoch 73/80 training time: 22.43 seconds
[Rank 0] Epoch 73/80 evaluation time: 10.60 seconds
Max accuracy so far: 67.9%
Epoch 73 - Test Acc: 67.3%, Test Loss: 0.868345
[Rank 0] Epoch 74/80 training time: 22.96 seconds
[Rank 0] Epoch 74/80 evaluation time: 11.01 seconds
Max accuracy so far: 67.9%
Epoch 74 - Test Acc: 67.6%, Test Loss: 0.867459
[Rank 0] Epoch 75/80 training time: 22.76 seconds
[Rank 0] Epoch 75/80 evaluation time: 10.47 seconds
Max accuracy so far: 67.9%
Epoch 75 - Test Acc: 66.7%, Test Loss: 0.876378
[Rank 0] Epoch 76/80 training time: 21.64 seconds
[Rank 0] Epoch 76/80 evaluation time: 10.91 seconds
Max accuracy so far: 67.9%
Epoch 76 - Test Acc: 66.8%, Test Loss: 0.877259
[Rank 0] Epoch 77/80 training time: 22.41 seconds
[Rank 0] Epoch 77/80 evaluation time: 10.59 seconds
Max accuracy so far: 67.9%
Epoch 77 - Test Acc: 67.1%, Test Loss: 0.867169
[Rank 0] Epoch 78/80 training time: 22.22 seconds
[Rank 0] Epoch 78/80 evaluation time: 10.77 seconds
Max accuracy so far: 67.9%
Epoch 78 - Test Acc: 66.9%, Test Loss: 0.871839
[Rank 0] Epoch 79/80 training time: 21.86 seconds
[Rank 0] Epoch 79/80 evaluation time: 10.85 seconds
Max accuracy so far: 67.9%
Epoch 79 - Test Acc: 67.2%, Test Loss: 0.871103
[Rank 0] Epoch 80/80 training time: 22.43 seconds
[Rank 0] Epoch 80/80 evaluation time: 10.82 seconds
Max accuracy so far: 67.9%
Epoch 80 - Test Acc: 66.5%, Test Loss: 0.875747
Saved checkpoint to checkpoints/model_epoch80.pth
Total training time: 2664.66 seconds, Average time per epoch: 33.31 seconds
DDP: Rank 5 process group destroyed.
DDP: Rank 2 process group destroyed.
DDP: Rank 6 process group destroyed.
DDP: Rank 4 process group destroyed.
DDP: Rank 1 process group destroyed.
DDP: Rank 7 process group destroyed.
DDP: Rank 3 process group destroyed.
Saved final model to results/2025-05-19_04-57-02/model_final.pth
Saved metrics to results/2025-05-19_04-57-02/metrics.json
DDP: Rank 0 process group destroyed.
